(()=>{var a={};a.id=276,a.ids=[276],a.modules={261:a=>{"use strict";a.exports=require("next/dist/shared/lib/router/utils/app-paths")},3295:a=>{"use strict";a.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},29294:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-async-storage.external.js")},44870:a=>{"use strict";a.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},56395:(a,b,c)=>{"use strict";c.r(b),c.d(b,{handler:()=>M,patchFetch:()=>L,routeModule:()=>H,serverHooks:()=>K,workAsyncStorage:()=>I,workUnitAsyncStorage:()=>J});var d={};c.r(d),c.d(d,{POST:()=>G,runtime:()=>B});var e=c(19225),f=c(84006),g=c(8317),h=c(99373),i=c(34775),j=c(24235),k=c(261),l=c(54365),m=c(90771),n=c(73461),o=c(67798),p=c(92280),q=c(62018),r=c(45696),s=c(47929),t=c(86439),u=c(37527),v=c(45592);let w=["Website Development Company in India","App Development Company in India","SaaS Product Development Company in India","Custom Software Development Company in India","IT Consulting and Services in India","SEO Services in India"],x=["Mumbai","Delhi","Bangalore","Hyderabad","Pune","Chennai","Ahmedabad","Kolkata"],y=["Consulting-led product execution","Startup-speed delivery with enterprise-grade quality","SEO-ready, conversion-focused implementation","Roadmap clarity with measurable outcomes"],z=["Offer a free consultation call","Ask project scope, budget, and timeline","Guide users to /contact for direct booking"],A=async(a,b)=>{var c;let d,e=a.name?.trim()||"",f=a.email?.trim().toLowerCase()||"",g=a.phone?.trim()||"",h=a.projectDetails?.trim()||"",i=a.budget?.trim()||"",j=a.timeline?.trim()||"";if(!e||!f||!g||!h||!i||!j)return{ok:!1,error:"All lead fields are required."};let{firstName:k,lastName:l}=(a=>{let[b,...c]=a.trim().replace(/\s+/g," ").split(" ");return{firstName:b||"Client",lastName:c.join(" ")||"Inquiry"}})(e),m=(c={name:e,email:f,phone:g,projectDetails:h,budget:i,timeline:j},d=b.filter(a=>"user"===a.role).slice(-3).map(a=>a.content).join("\n- "),["Lead Source: AI Chatbot",`Phone: ${c.phone}`,`Budget: ${c.budget}`,`Timeline: ${c.timeline}`,`Project Details: ${c.projectDetails}`,d?`Recent User Questions:
- ${d}`:""].filter(Boolean).join("\n"));try{let a=await fetch(`${process.env.NEXT_PUBLIC_API_BASE_URL||"http://localhost:4000"}/api/inquiry`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({firstName:k,lastName:l,email:f,message:m}),cache:"no-store"}),b=await a.json().catch(()=>({}));if(!a.ok||!b?.ok)return{ok:!1,error:b?.error||"Failed to save lead."};return{ok:!0,id:b.id}}catch(a){return{ok:!1,error:"Lead service is temporarily unavailable."}}},B="nodejs",C=new Map,D=/(price|pricing|cost|quote|budget|timeline|project|proposal|hire|consultation|demo)/i,E=a=>{let b=[...a].reverse().find(a=>"user"===a.role)?.content||"",c=D.test(b);return{reply:c?"We can help with that. Please share your Name, Email, Phone, Budget, Timeline, and Project Details for a free consultation plan.":"We help with Website Development, App Development, SaaS Product Development, Custom Software, SEO, and IT Consulting across India. Share your goal and I can suggest the best next step.",shouldCaptureLead:c}},F=async a=>{let b=process.env.OPENAI_API_KEY;if(!b)return E(a);let c=await fetch("https://api.openai.com/v1/chat/completions",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${b}`},body:JSON.stringify({model:"gpt-4o-mini",temperature:.3,response_format:{type:"json_object"},messages:[{role:"system",content:`
You are a senior AI sales engineer for WebOrbitSolution.

Goals:
1) Answer clearly using the company knowledge below.
2) Push high-intent users toward consultation booking.
3) Trigger lead capture when users ask about pricing, cost, timelines, project execution, hiring, or proposal requests.
4) Keep responses concise, practical, and professional.

Company Knowledge:
- Target Audience: Startups, SMEs, and enterprises across India
- Core Services: ${w.join(", ")}
- PAN India Presence: ${x.join(", ")}
- Value Proposition: ${y.join(", ")}
- Conversion Hooks: ${z.join(", ")}

Conversation Rules:
- Be accurate. Do not invent unavailable details.
- If the user asks for pricing/cost, provide realistic ranges and recommend a scoped consultation.
- If user intent is high (pricing, timeline, "need a team", "start project", "quote"), request lead capture fields:
  Name, Email, Phone, Project Details, Budget, Timeline.
- If unsure, ask one clarifying question.
- For India audience, keep language clear and direct.

Output Rules (CRITICAL):
- Return ONLY valid JSON with this exact shape:
{
  "reply": "string",
  "shouldCaptureLead": true|false
}
- "reply" must be plain text only (no markdown).
`.trim()},...a]}),cache:"no-store"});if(!c.ok)return E(a);let d=await c.json().catch(()=>({})),e=d?.choices?.[0]?.message?.content;if(!e||"string"!=typeof e)return E(a);try{let b=JSON.parse(e);return{reply:String(b.reply||"").trim()||E(a).reply,shouldCaptureLead:!!b.shouldCaptureLead}}catch{return E(a)}};async function G(a){var b;let c,d,e;if(c=a.headers.get("x-forwarded-for")||"",b=c.split(",")[0]?.trim()||"unknown",d=Date.now(),(e=C.get(b))&&!(d>e.resetAt)?e.count>=25||(e.count+=1,!1):(C.set(b,{count:1,resetAt:d+6e4}),!1))return v.NextResponse.json({error:"Too many requests. Please try again in a minute."},{status:429});let f=await a.json().catch(()=>({})),g=((a=[])=>a.filter(a=>a&&("user"===a.role||"assistant"===a.role)&&"string"==typeof a.content).map(a=>({role:a.role,content:a.content.trim().slice(0,600)})).filter(a=>a.content.length>0).slice(-12))(f.messages||[]);if(f.submitLead){if(!f.lead)return v.NextResponse.json({error:"Lead details are missing."},{status:400});let a=await A(f.lead,g);return a.ok?v.NextResponse.json({reply:"Thank you. Your consultation request is submitted successfully. Our team will contact you shortly to discuss scope, timeline, and pricing.",shouldCaptureLead:!1,leadSaved:!0}):v.NextResponse.json({error:a.error||"Unable to capture lead."},{status:500})}if(0===g.length)return v.NextResponse.json({reply:"Welcome to WebOrbitSolution. We provide Website, App, SaaS, and Custom Software development across India. What are you planning to build?",shouldCaptureLead:!1});try{let a=await F(g);return v.NextResponse.json(a)}catch{return v.NextResponse.json(E(g))}}let H=new e.AppRouteRouteModule({definition:{kind:f.RouteKind.APP_ROUTE,page:"/api/chat/route",pathname:"/api/chat",filename:"route",bundlePath:"app/api/chat/route"},distDir:".next",relativeProjectDir:"",resolvedPagePath:"/Users/sumitgautam/Desktop/weborbitsolution--1-/client/app/api/chat/route.ts",nextConfigOutput:"",userland:d}),{workAsyncStorage:I,workUnitAsyncStorage:J,serverHooks:K}=H;function L(){return(0,g.patchFetch)({workAsyncStorage:I,workUnitAsyncStorage:J})}async function M(a,b,c){H.isDev&&(0,h.addRequestMeta)(a,"devRequestTimingInternalsEnd",process.hrtime.bigint());let d="/api/chat/route";"/index"===d&&(d="/");let e=await H.prepare(a,b,{srcPage:d,multiZoneDraftMode:!1});if(!e)return b.statusCode=400,b.end("Bad Request"),null==c.waitUntil||c.waitUntil.call(c,Promise.resolve()),null;let{buildId:g,params:v,nextConfig:w,parsedUrl:x,isDraftMode:y,prerenderManifest:z,routerServerContext:A,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,resolvedPathname:D,clientReferenceManifest:E,serverActionsManifest:F}=e,G=(0,k.normalizeAppPath)(d),I=!!(z.dynamicRoutes[G]||z.routes[D]),J=async()=>((null==A?void 0:A.render404)?await A.render404(a,b,x,!1):b.end("This page could not be found"),null);if(I&&!y){let a=!!z.routes[D],b=z.dynamicRoutes[G];if(b&&!1===b.fallback&&!a){if(w.experimental.adapterPath)return await J();throw new t.NoFallbackError}}let K=null;!I||H.isDev||y||(K="/index"===(K=D)?"/":K);let L=!0===H.isDev||!I,M=I&&!L;F&&E&&(0,j.setManifestsSingleton)({page:d,clientReferenceManifest:E,serverActionsManifest:F});let N=a.method||"GET",O=(0,i.getTracer)(),P=O.getActiveScopeSpan(),Q={params:v,prerenderManifest:z,renderOpts:{experimental:{authInterrupts:!!w.experimental.authInterrupts},cacheComponents:!!w.cacheComponents,supportsDynamicResponse:L,incrementalCache:(0,h.getRequestMeta)(a,"incrementalCache"),cacheLifeProfiles:w.cacheLife,waitUntil:c.waitUntil,onClose:a=>{b.on("close",a)},onAfterTaskError:void 0,onInstrumentationRequestError:(b,c,d,e)=>H.onRequestError(a,b,d,e,A)},sharedContext:{buildId:g}},R=new l.NodeNextRequest(a),S=new l.NodeNextResponse(b),T=m.NextRequestAdapter.fromNodeNextRequest(R,(0,m.signalFromNodeResponse)(b));try{let e=async a=>H.handle(T,Q).finally(()=>{if(!a)return;a.setAttributes({"http.status_code":b.statusCode,"next.rsc":!1});let c=O.getRootSpanAttributes();if(!c)return;if(c.get("next.span_type")!==n.BaseServerSpan.handleRequest)return void console.warn(`Unexpected root span type '${c.get("next.span_type")}'. Please report this Next.js issue https://github.com/vercel/next.js`);let e=c.get("next.route");if(e){let b=`${N} ${e}`;a.setAttributes({"next.route":e,"http.route":e,"next.span_name":b}),a.updateName(b)}else a.updateName(`${N} ${d}`)}),g=!!(0,h.getRequestMeta)(a,"minimalMode"),j=async h=>{var i,j;let k=async({previousCacheEntry:f})=>{try{if(!g&&B&&C&&!f)return b.statusCode=404,b.setHeader("x-nextjs-cache","REVALIDATED"),b.end("This page could not be found"),null;let d=await e(h);a.fetchMetrics=Q.renderOpts.fetchMetrics;let i=Q.renderOpts.pendingWaitUntil;i&&c.waitUntil&&(c.waitUntil(i),i=void 0);let j=Q.renderOpts.collectedTags;if(!I)return await (0,p.I)(R,S,d,Q.renderOpts.pendingWaitUntil),null;{let a=await d.blob(),b=(0,q.toNodeOutgoingHttpHeaders)(d.headers);j&&(b[s.NEXT_CACHE_TAGS_HEADER]=j),!b["content-type"]&&a.type&&(b["content-type"]=a.type);let c=void 0!==Q.renderOpts.collectedRevalidate&&!(Q.renderOpts.collectedRevalidate>=s.INFINITE_CACHE)&&Q.renderOpts.collectedRevalidate,e=void 0===Q.renderOpts.collectedExpire||Q.renderOpts.collectedExpire>=s.INFINITE_CACHE?void 0:Q.renderOpts.collectedExpire;return{value:{kind:u.CachedRouteKind.APP_ROUTE,status:d.status,body:Buffer.from(await a.arrayBuffer()),headers:b},cacheControl:{revalidate:c,expire:e}}}}catch(b){throw(null==f?void 0:f.isStale)&&await H.onRequestError(a,b,{routerKind:"App Router",routePath:d,routeType:"route",revalidateReason:(0,o.c)({isStaticGeneration:M,isOnDemandRevalidate:B})},!1,A),b}},l=await H.handleResponse({req:a,nextConfig:w,cacheKey:K,routeKind:f.RouteKind.APP_ROUTE,isFallback:!1,prerenderManifest:z,isRoutePPREnabled:!1,isOnDemandRevalidate:B,revalidateOnlyGenerated:C,responseGenerator:k,waitUntil:c.waitUntil,isMinimalMode:g});if(!I)return null;if((null==l||null==(i=l.value)?void 0:i.kind)!==u.CachedRouteKind.APP_ROUTE)throw Object.defineProperty(Error(`Invariant: app-route received invalid cache entry ${null==l||null==(j=l.value)?void 0:j.kind}`),"__NEXT_ERROR_CODE",{value:"E701",enumerable:!1,configurable:!0});g||b.setHeader("x-nextjs-cache",B?"REVALIDATED":l.isMiss?"MISS":l.isStale?"STALE":"HIT"),y&&b.setHeader("Cache-Control","private, no-cache, no-store, max-age=0, must-revalidate");let m=(0,q.fromNodeOutgoingHttpHeaders)(l.value.headers);return g&&I||m.delete(s.NEXT_CACHE_TAGS_HEADER),!l.cacheControl||b.getHeader("Cache-Control")||m.get("Cache-Control")||m.set("Cache-Control",(0,r.getCacheControlHeader)(l.cacheControl)),await (0,p.I)(R,S,new Response(l.value.body,{headers:m,status:l.value.status||200})),null};P?await j(P):await O.withPropagatedContext(a.headers,()=>O.trace(n.BaseServerSpan.handleRequest,{spanName:`${N} ${d}`,kind:i.SpanKind.SERVER,attributes:{"http.method":N,"http.target":a.url}},j))}catch(b){if(b instanceof t.NoFallbackError||await H.onRequestError(a,b,{routerKind:"App Router",routePath:G,routeType:"route",revalidateReason:(0,o.c)({isStaticGeneration:M,isOnDemandRevalidate:B})},!1,A),I)throw b;return await (0,p.I)(R,S,new Response(null,{status:500})),null}}},63033:a=>{"use strict";a.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},86439:a=>{"use strict";a.exports=require("next/dist/shared/lib/no-fallback-error.external")},96487:()=>{}};var b=require("../../../webpack-runtime.js");b.C(a);var c=b.X(0,[3445,1813],()=>b(b.s=56395));module.exports=c})();